<!--pages/note/note.wxml-->
<scroll-view class="scroll" scroll-x="true" scroll-left="{{edit?'425rpx':useMarkdown?'1175rpx':'425rpx'}}"
  enable-flex="true" enhanced="true" showScrollbar="false" paging-enabled="true"
  style="--rgbaprimaryColor--:{{rgbaPrimaryColor}}" bindscrolltoupper="scroll">
  <scroll-view scroll-y="true" style="height:{{windowHeight-130}}px;" class="side_bg">
    <view class="side">
      <view class="photos">
        <view class="subtitle" style="color:{{primaryColor}};">
          <text>图库</text>
        </view>
        <view class="empty" style="height: 500rpx;" wx:if="{{tempImgs.length == 0 && galleryDetail.length == 0}}">
          <image src="/source/img/empty.png" mode="widthFix"></image>
          <text>无内容</text>
        </view>
        <view class="Imgs">
          <view class="Img" wx:for="{{galleryDetail}}" wx:key="index">
            <image mode="aspectFill" src="{{item.tempFileURL}}" bindtap="previewImg" data-index="{{index}}"
              data-url="{{item.tempFileURL}}"></image>
            <view class="deleteImg" hover-class="hover" data-index="{{index}}" bindtap="deleteImg" wx:if="{{edit}}">
              <text class="material-icons">clear</text>
            </view>
          </view>
        </view>
        <view class="Imgs">
          <view class="Img" wx:for="{{tempImgs}}" wx:key="index">
            <image mode="aspectFill" src="{{item}}" bindtap="previewTempImg" data-index="{{index}}" data-url="{{item}}">
            </image>
            <view class="deleteImg" hover-class="hover" data-index="{{index}}" bindtap="deleteTempImg" wx:if="{{edit}}">
              <text class="material-icons">clear</text>
            </view>
          </view>
        </view>
      </view>
      <view class="radio">
        <view class="subtitle" style="color:{{primaryColor}};">
          <text>音频</text>
        </view>
        <view class="empty" style="height: 200rpx;" wx:if="{{true}}">
          <!-- <image src="/source/img/empty.png" mode="widthFix"></image> -->
          <text>无内容</text>
        </view>
      </view>
      <view class="settings">
        <view class="subtitle" style="color:{{primaryColor}};">
          <text>配置项</text>
        </view>
        <md-picker class="picker" bind:pick="pick" primaryColor="{{primaryColor}}"
          rgbaPrimaryColor="{{rgbaPrimaryColor}}" dataset="{{categoryData}}" data-id="category" disabled="{{!edit}}"
          selected="{{category}}">
          <text slot="title">类别</text>
          <text slot="subtitle">笔记所属类别</text>
        </md-picker>
        <md-switch class="switch" bind:switch="switch" primaryColor="{{primaryColor}}"
          rgbaPrimaryColor="{{rgbaPrimaryColor}}" selected="{{encrypt}}" data-id="encrypt" disabled="{{!edit}}">
          <text slot="title">加密</text>
          <text slot="subtitle">浏览时验证密码</text>
        </md-switch>
        <md-input class="input" bind:input="input" primaryColor="{{primaryColor}}"
          rgbaPrimaryColor="{{rgbaPrimaryColor}}" value="{{password}}" data-id="password" wx:if="{{encrypt}}"
          disabled="{{!edit}}">
          <text slot="title">访问密码</text>
          <text slot="subtitle">点击设置密码</text>
        </md-input>
        <md-switch class="switch" bind:switch="switch" primaryColor="{{primaryColor}}"
          rgbaPrimaryColor="{{rgbaPrimaryColor}}" selected="{{useMarkdown}}" data-id="useMarkdown" disabled="{{!edit}}">
          <text slot="title">Markdown 模式</text>
          <text slot="subtitle">使用 Markdown 渲染\n同时启用预览视窗</text>
        </md-switch>
      </view>
    </view>
  </scroll-view>
  <scroll-view scroll-y="true" style="height:{{windowHeight-130}}px;" enhanced="true" bindscrolltoupper="toUpper"
    upper-threshold="20" bindscroll="scroll">
    <view class="main">
      <view class="heading">
        <input type="text" value="{{heading}}" disabled="{{!edit}}" style="{{headingStyle}}" placeholder="标题"
          placeholder-class="placeholder" name="heading" maxlength="20" cursor-spacing="300" confirm-type="next"
          bindfocus="headingFocus" bindblur="headingBlur" bindinput="headingInput"></input>
        <view class="num" wx:if="{{edit}}">
          <text style="{{headingNumStyle}}">{{headingNum}}/20</text>
        </view>
      </view>
      <editor id="editor" class="ql-container" placeholder="请输入内容…" show-img-size="true" show-img-resize="true"
        show-img-toolbar="true" bindstatuschange="onStatusChange" bindready="onEditorReady">
      </editor>
      <!-- <view class="content" bindtap="contentTap">
        <textarea name="content" value="{{content}}" disabled="{{!edit}}" placeholder="内容"
          placeholder-class="placeholder" maxlength="-1" auto-height="true" cursor-spacing="300" id=""
          confirm-type="return" bindfocus="contentFocus" bindblur="contentBlur" bindinput="contentInput"></textarea>
        <view class="num" wx:if="{{edit}}">
          <text style="{{contentNumStyle}}">{{contentNum}}/∞</text>
        </view>
      </view> -->
    </view>
  </scroll-view>






  <scroll-view wx:if="{{false && useMarkdown}}" class="preview_bg" scroll-y="true"
    style="height:{{windowHeight-130}}px;" enhanced="true" bindscrolltoupper="toUpper" upper-threshold="20"
    bindscroll="scroll">
    <view class="preview">
      <view class="heading"
        style="display:flex;flex-direction:row;justify-content:space-between;align-items:center;--rgbaprimaryColor--:{{rgbaPrimaryColor}};">
        <view>
          <text>Markdown 预览</text>
        </view>
        <view class="btn" style="color:{{primaryColor}};{{btnStyle}};" hover-class="btnp" bindtap="previewRefresh">
          <text class="material-icons">refresh</text>
          <text>刷新</text>
        </view>
      </view>
      <view class="preview_container">
        <wemark md="{{md}}" link highlight type="wemark"></wemark>
      </view>
      <view class="subtitle" style="color:{{primaryColor}};">
        <text>配置项</text>
      </view>
      <md-switch class="switch" bind:switch="switch" primaryColor="{{primaryColor}}"
        rgbaPrimaryColor="{{rgbaPrimaryColor}}" selected="{{markdownPreview}}" data-id="markdownPreview">
        <text slot="title">同步刷新</text>
        <text slot="subtitle">自动更新 Markdown 预览</text>
      </md-switch>
      <md-picker class="picker" bind:pick="pick" primaryColor="{{primaryColor}}" rgbaPrimaryColor="{{rgbaPrimaryColor}}"
        dataset="{{markdownPreviewDelayData}}" selected='{{markdownPreviewDelay - 1}}' disabled="{{!markdownPreview}}"
        data-id="markdownPreviewDelay">
        <text slot="title">刷新延时</text>
        <text slot="subtitle">自动刷新等待的无操作时间（秒）\n过低的秒数可能影响性能</text>
      </md-picker>
    </view>
  </scroll-view>
  <!-- 平板上下布局 -->
  <!-- <scroll-view wx:if="{{isPad}}" class="preview_bg" scroll-y="true" style="height:{{windowHeight-130}}px;"
    enhanced="true" bindscrolltoupper="toUpper" upper-threshold="20" bindscroll="scroll">
    <view class="main">
      <form action="" method="post" bindsubmit="submit" bindreset="reset">
        <view class="heading">
          <input type="text" value="{{heading}}" disabled="{{!edit}}" style="{{headingStyle}}" placeholder="标题"
            placeholder-class="placeholder" name="heading" maxlength="20" cursor-spacing="300" confirm-type="next"
            bindfocus="headingFocus" bindblur="headingBlur" bindinput="headingInput"></input>
          <view class="num" wx:if="{{edit}}">
            <text style="{{headingNumStyle}}">{{headingNum}}/20</text>
          </view>
        </view>
        <view class="content" bindtap="contentTap">
          <textarea name="content" value="{{content}}" disabled="{{!edit}}" placeholder="内容"
            placeholder-class="placeholder" maxlength="-1" auto-height="true" cursor-spacing="300" id=""
            confirm-type="return" bindfocus="contentFocus" bindblur="contentBlur" bindinput="contentInput"></textarea>
          <view class="num" wx:if="{{edit}}">
            <text style="{{contentNumStyle}}">{{contentNum}}/∞</text>
          </view>
        </view>
      </form>
    </view>
    <view class="preview" wx:if="{{useMarkdown}}">
      <view class="heading"
        style="display:flex;flex-direction:row;justify-content:space-between;align-items:center;--rgbaprimaryColor--:{{rgbaPrimaryColor}};">
        <view>
          <text>Markdown 预览</text>
        </view>
        <view class="btn" style="color:{{primaryColor}};{{btnStyle}};" hover-class="btnp" bindtap="previewRefresh">
          <text class="material-icons">refresh</text>
          <text>刷新</text>
        </view>
      </view>
      <view class="preview_container">
        <wemark md="{{md}}" link highlight type="wemark"></wemark>
      </view>
      <view class="subtitle" style="color:{{primaryColor}};">
        <text>配置项</text>
      </view>
      <md-switch class="switch" bind:switch="switch" primaryColor="{{primaryColor}}"
        rgbaPrimaryColor="{{rgbaPrimaryColor}}" selected="{{markdownPreview}}" data-id="markdownPreview">
        <text slot="title">同步刷新</text>
        <text slot="subtitle">自动更新 Markdown 预览</text>
      </md-switch>
      <md-picker class="picker" bind:pick="pick" primaryColor="{{primaryColor}}" rgbaPrimaryColor="{{rgbaPrimaryColor}}"
        dataset="{{markdownPreviewDelayData}}" selected='{{markdownPreviewDelay - 1}}' disabled="{{!markdownPreview}}"
        data-id="markdownPreviewDelay">
        <text slot="title">刷新延时</text>
        <text slot="subtitle">自动刷新等待的无操作时间（秒）\n过低的秒数可能影响性能</text>
      </md-picker>
    </view>
  </scroll-view> -->

</scroll-view>

<view class="head_bar" style="--rgbaprimaryColor--:{{rgbaPrimaryColor}};{{headbarStyle}}">
  <view class="icon material-icons" hover-class="hover" bindtap="back">
    <text>arrow_back</text>
  </view>
</view>
<view class="bottom_bar" style="--rgbaprimaryColor--:{{rgbaPrimaryColor}};">
  <view class="icon material-icons" hover-class="hover" bindtap="addImg">
    <text>add_photo_alternate</text>
  </view>
  <view class="icon material-icons" hover-class="hover" bindtap="">
    <text>attachment</text>
  </view>
  <view class="icon material-icons" hover-class="hover">
    <text>keyboard_voice</text>
  </view>
  <view class="icon material-icons" hover-class="hover">
    <text>share</text>
  </view>
  <view class="icon material-icons" hover-class="hover" bindtap="delete">
    <text>delete</text>
  </view>
</view>

<view class="float" style="{{floatStyle}}" bindtap="floatTap">
  <view class="float_color" style="--rgbaprimaryColor--:{{rgbaPrimaryColor}}" hover-class="hover">
    <view class="material-icons" style="color:{{primaryColor}};"><text>{{edit?edited?'save':'done':'edit'}}</text>
    </view>
  </view>
</view>

<view class="bottom_bar toolbar" catchtouchend="format" hidden="{{keyboardHeight > 0 ? false : false}}"
  style="bottom: {{isIOS ? keyboardHeight : 0}}px;--rgbaprimaryColor--:{{rgbaPrimaryColor}};">
  <view class="icon material-icons" hover-class="hover">
    <text>add_photo_alternate</text>
  </view>
  <view class="icon material-icons" hover-class="hover">
    <text>format_size</text>
  </view>
  <view class="icon material-icons" hover-class="hover">
    <text>format_bold</text>
  </view>
  <view class="icon material-icons" hover-class="hover">
    <text>format_italic</text>
  </view>
  <view class="icon material-icons" hover-class="hover">
    <text>format_underlined</text>
  </view>
  <view class="icon material-icons" hover-class="hover">
    <text>format_align_left</text>
  </view>
  <view class="icon material-icons" hover-class="hover">
    <text>check_box</text>
  </view>
  <view class="icon material-icons" hover-class="hover">
    <text>format_list_numbered</text>
  </view>
  <view class="icon material-icons" hover-class="hover">
    <text>format_list_bulleted</text>
  </view>
</view>

<view class="snackbar" style="{{snackbarStyle}}">
  <text>{{snackbarContent}}</text>
</view>